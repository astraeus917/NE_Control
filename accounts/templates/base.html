{% load static %}
<!DOCTYPE html>
<html lang="pt_BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{% endblock %}</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Style.css -->
    <link rel="stylesheet" href="{% static 'style.css' %}" />
  </head>
  <body class="bg-gray-100">

    <!-- Pop-up de alertas do site -->
    {% if messages %}
        <div id="messages-container" class="fixed top-5 right-5 space-y-2 z-50">
            {% for msg in messages %}
                <div class="popup-message px-4 py-2 rounded shadow-md transition-opacity duration-500
                    {% if msg.tags == 'success' %}bg-green-500 text-white
                    {% elif msg.tags == 'error' %}bg-red-500 text-white
                    {% elif msg.tags == 'warning' %}bg-yellow-500 text-black
                    {% elif msg.tags == 'info' %}bg-blue-500 text-white
                    {% else %}bg-gray-500 text-white{% endif %}">
                    {{ msg }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Menu de navegação do site -->
    <nav class="bg-gray-800 flex p-6 items-center">
      <div class="flex shrink items-center">
        <img
          src="{% static 'img\logo.png' %}"
          alt="Your Company"
          class="h-12 w-auto"
        />
      </div>
      <div
        class="flex items-center justify-center sm:items-stretch sm:justify-start"
      >
        <div class="hidden sm:ml-6 sm:block">
          <div class="flex space-x-4">
            <a
              class="{% if active_page == 'control' %} bg-gray-900 {% endif %} rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white"
              href="{% url 'control' %}"
              >Minhas NEs</a
            >
            <a
              class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white"
              href="{% url 'list' %}"
              >Todas as NEs</a
            >
            {% if user.role == 'admin' %}
            <a class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white" href="{% url 'manage' %}">Gestão</a>
            <a class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white" href="{% url 'admin:index' %}">Administração</a>
            {% endif %}
          </div>
        </div>
      </div>
      <div
        class="flex grow justify-end"
      >
        <div class="flex hidden justify-items-end justify-self-end sm:ml-6 sm:block">
            
          <div class="flex space-x-4">
            <a
              class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white"
              href=""
              >{{ user }}</a
            >

            <a href="{% url 'logout' %}">Sair</a>
            </div>

        </div>
      </div>
    </nav>

    <!-- Conteúdo do Sistema -->
    {% block content %}{% endblock %}

<!-- Scripts JS -->
<script>
    // Função para esconder todos os pop-ups após 3 segundos.
    function hidePopupsAfterDelay() {
        setTimeout(() => {
            document.querySelectorAll(".popup-message").forEach(el => {
                el.classList.add("opacity-0");
                setTimeout(() => el.remove(), 500);
            });
        }, 3000);
    }

    // Função para ativar a pesquisa dinâmica na tabela.
    function enableSearch(inputId, targetSelector) {
        const searchInput = document.getElementById(inputId);

        if (!searchInput) return;

        searchInput.addEventListener("input", function () {
            const term = this.value.toLowerCase();
            const lines = document.querySelectorAll(targetSelector);

            lines.forEach(line => {
                const text = line.textContent.toLowerCase();
                line.style.display = text.includes(term) ? "" : "none";
            });
        });
    }

    // Função para simular um acordeon.
    function toggleAccordion(id) {
        const content = document.getElementById(id);
        const icon = document.getElementById('icon-' + id);

        if (content.classList.contains('hidden')) {
            content.classList.remove('hidden');
            icon.classList.add('rotate-180');
        } else {
            content.classList.add('hidden');
            icon.classList.remove('rotate-180');
        }
    }

    // Executando as funções.
    hidePopupsAfterDelay();
    enableSearch("search", ".table-line");
</script>
</body>
</html>
